# Dockerfile for tau2-bench Purple Agent (Baseline LLM Agent)
FROM python:3.11-slim

WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y --no-install-recommends \
    git \
    && rm -rf /var/lib/apt/lists/*

# Install uv for fast Python package management
RUN pip install uv

# Copy the entire tau2-bench project
COPY . /app/

# Install the main tau2 package
RUN pip install -e .

# Install agentify_tau_bench dependencies
WORKDIR /app/src/experiments/agentify_tau_bench
RUN uv sync

# Set environment variables
ENV PYTHONPATH=/app/src:/app/src/experiments/agentify_tau_bench/src
ENV TAU2_DATA_DIR=/app/data
ENV ROLE=white
ENV HOST=0.0.0.0
ENV AGENT_PORT=9002
ENV AGENT_URL=http://localhost:9002

# Expose port for purple agent
EXPOSE 9002

# Default command: start the purple (white) agent
CMD ["uv", "run", "tau-bench-agent", "white"]
